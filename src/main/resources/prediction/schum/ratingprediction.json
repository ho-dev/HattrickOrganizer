{

  "ratings" : {
    "_description" : "Rating formulas",
    "defence" : {
      "_description" : "Rating formulas of the defence lines",
      "central" : {
        "_description" : "Rating formula of the central defence line",
        "sum": [
          {"expression":"$expressions.playerStrength", "args": ["goalkeeping","gk", "normal", 0.135452380952381]},
          {"expression":"$expressions.playerStrength", "args": ["defending","gk", "normal", 0.066225]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "normal", 0.07068]}, {"expression" : "$expressions.overcrowding", "args" : ["cd"]}]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "offensive", 0.0651]},{ "expression" : "$expressions.overcrowding", "args" : ["cd"]}]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "wing", 0.07998]}, {"expression" : "$expressions.overcrowding", "args" :["cd"]}]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "normal", 0.07068]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "offensive", 0.0651]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "defensive", 0.07998]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "middle", 0.1302]},

          {"expression":"$expressions.playerExperience", "args": ["gk", "normal",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "normal",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "offensive",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "wing",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "normal",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "offensive", "$objects.devineExperienceContribution.cd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "defensive",  "$objects.devineExperienceContribution.cd"]},
          {"expression":"p$expressions.layerExperience", "args": ["wb", "middle",  "$objects.devineExperienceContribution.cd"]}
        ]
      },
      "side": {
        "_description" : "Rating formula of the side defence lines",
        "sum": [
          {"expression":"$expressions.playerStrength", "args": ["goalkeeping","gk", "normal", 0.135452380952381]},
          {"expression":"$expressions.playerStrength", "args": ["defending","gk", "normal", 0.066225]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "normal", 0.07068]}, {"expression" : "$expressions.overcrowding", "args" : ["cd"]}]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "offensive", 0.0651]},{ "expression" : "$expressions.overcrowding", "args" : ["cd"]}]},
          { "product" : [{"expression":"$expressions.playerStrength", "args": ["defending","cd", "wing", 0.07998]}, {"expression" : "$expressions.overcrowding", "args" :["cd"]}]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "normal", 0.07068]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "offensive", 0.0651]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "defensive", 0.07998]},
          {"expression":"$expressions.playerStrength", "args": ["defending","wb", "middle", 0.1302]},

          {"expression":"$expressions.playerExperience", "args": ["gk", "normal",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "normal",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "offensive",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["cd", "wing",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "normal",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "offensive", "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "defensive",  "$objects.devineExperienceContribution.sd"]},
          {"expression":"$expressions.playerExperience", "args": ["wb", "middle",  "$objects.devineExperienceContribution.sd"]}
        ]
      }
    },
    "midfield" : {
      "central" : {
        "sum": []

      }
    },
    "attack" : {
      "central" : {
        "sum": []

      },
      "side": {
        "sum": []

      }
    }
  },

  "objects": [
    {
      "overcrowdingCoefficients" : {
        "cd" :  [1,1,0.964, 0.9],
        "fw" :  [1,1,0.945, 0.865],
        "im" :  [1,1,0.935, 0.825]
      },
      "devineExperienceContribution" : {
        "cd" :  0.48,
        "sd" :  0.345,
        "fw" :  0.45,
        "sf" :  0.375,
        "im" :  0.73
      }
    }
  ],

  "expressions" : [
    {
      "overcrowding" : {
        "args": ["sector"],
        "result": {
          "expression": "overcrowdingFactor", "args": ["/sector", { "count": { "playersInSector": ["/sector"]}}]
        }
      }
    },
    {
      "overcrowdingFactor" : {
        "args": ["sector", "count"],
        "result": {
          "value": "$.objects.overcrowdingCoefficients.sectors./sector[/count]"
        }
      }
    },
    {
      "skill" : {
        "args": ["skillValue"],
        "result": {
          "max": [0, { "sum": [-1, "/skillValue"]}]
        }
      }
    },
    {
      "form" : {
        "args": [
          "formValue"
        ],
        "result": {
          "polynomial": {
            "value": "/formValue",
            "coefficients": [0.048, 0.191, -0.009]
          }
        }
      }
    },
    {
      "experience": {
        "args": ["experienceValue"],
        "result": {
          "polynomial": {
            "value": "/experienceValue",
            "coefficients": [
              -0.18965312,
              0.20426157,
              -0.01507852,
              0.00056438,
              -0.00000862
            ]
          }
        }
      }
    },
    {
      "staminaGradient": {
        "args" : ["staminaValue", "isPressing"],
        "result" : {
          "min" : [
            -3.25,
            {
              "product" : [
                {"if" :  "/isPressing", "then":  1.1},
                {"sum" :  [
                  -5.95,
                  {"quotient" :  [{"product" :["/staminaValue", 27]},70]}
                ]}
              ]
            }
          ]
        }
      }
    },
    {
      "staminaStartvalue": {
        "args" : ["staminaValue"],
        "result": {
          "sum" : [
            102,
            { "if" :  { "ge":  ["/staminaValue", 7]},
              "then" :  {"sum" :  [23, {"quotient" :  [{"product":  [{"sum":  ["/staminaValue", -7]}, 100]}, 7]}]},
              "else" :  {"quotient" :  [{"product" :  ["/staminaValue", 23]},7]}
            }
          ]
        }
      }
    },
    {
      "stamina" : {
        "args": ["minute", "startMinute", "staminaValue", "isPressing"],
        "instructions" : [
          { "variable": "gradient", "value" : {"expression":  "$expressions.staminaGradient", "args":  ["/staminaValue", "isPressing"]}},
          { "variable": "startValue", "value" : { "expression" : "$expressions.staminaStartValue", "args" : ["/staminaValue"]}},
          { "variable": "ret", "value" : "/startValue"},
          { "for" :  [
            { "int" :  "i", "values":  [{"sum": ["/startMinute", 5]}, "minute", 5]},
            { "set" :  "/ret", "value": {"sum": ["/ret", "/gradient"]}}
          ]}
        ],
        "result": {

          "quotient" : [
            { "min" :  [
              100,
              {"sum": [
                "/startValue",
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 10]}, {"ge": ["minute", 10]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 15]}, {"ge": ["minute", 15]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 20]}, {"ge": ["minute", 20]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 25]}, {"ge": ["minute", 25]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 30]}, {"ge": ["minute", 30]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 35]}, {"ge": ["minute", 35]}]}, "then" :   "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 40]}, {"ge": ["minute", 40]}]}, "then" :  "/gradient"},

                { "if" :  {"and" :  [{"lt" : ["/startMinute", 45]}, {"ge": ["minute", 45]}]}, "then" :  "/gradient"},

                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"},
                { "if" :  {"and" :  [{"lt" : ["/startMinute", 5]}, {"ge": ["minute", 5]}]}, "then" :  "/gradient"}
              ]}
            ]},
            100
          ]
        }
      }
    },
    {
      "playerStrength": {
        "args": ["skillName", "sector", "orientation", "weight"],
        "result": {
          "product": [
            "/weight",
            {"expression": "$expressions.form", "args": [{"value": ["form", "/sector", "/orientation"]}]},
            {
              "sum": [
                {"expression": "$expressions.skill", "args": [{"value": ["/skillName", "/sector", "/orientation"]}]},
                {"product": [0.0526, {"value": ["loyalty", "/sector", "/orientation"]}]},
                {"if": {"value": ["isHomegrown", "/sector", "/orientation"]}, "then": 0.5}
              ]
            }
          ]
        }
      }

    },
    {
      "playerExperience" : {
        "args": ["sector", "orientation", "weight"],
        "result": {
          "product": ["/weight", {"expression": "$expressions.experience","args": [{"value": ["$expressions.experience", "/sector", "/orientation"]}]}]
        }
      }
    }
  ]
}